<div id="page-content">
    <div class="card card-md">
        <div class="card-header">Log in</div>

        <form action="#" method="post">
            <paper-input-decorator floatingLabel label="Username">
                <input is="core-input" name="username" id="username">
            </paper-input-decorator>

            <paper-input-decorator floatingLabel label="Password">
                <input is="core-input" name="password" id="password" type="password">
            </paper-input-decorator>

            <div horizontal center-justified layout>
                <button type="submit" id="connexion" onclick="document.getElementById('toast').show()" is="paper-button-submit">
                    Log in
                </button>
            </div>

            <paper-toast id="toast" text="Your username or password is incorrect."></paper-toast>
        </form>

        <script>
        $(function() {
            'use strict';

            /**
             * Logs the user in.
             *
             * @param  {object} e The event
             */
            $('#connexion').on('click', function(e) {
                e.preventDefault();
                var username = $('#username').val();
                var password = $('#password').val();

                $.ajax({
                    type: 'GET',
                    url: '/users.json',
                    dataType: 'json',
                    success: function(users) {
                        users.forEach(function(user) {
                            if (user.username == username && user.password == password) {
                                $('#login').html('Connecté en tant que ' + user.username);
                                $('#credit').html('Crédits = ' + user.credits);
                                $(location).attr('href', '#home');
                                return;
                            }
                        });
                    },
                    error: function(err) {
                        $().log('Problème de connexion au serveur');
                    }
                });
            });
        });
        </script>
    </div>
</div>
